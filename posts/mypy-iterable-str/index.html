<!doctype html><html lang=en><head><meta charset=utf-8><title>Leo Robinovitch @ The Leo Zone</title><link rel=icon href=/img/favicon.png type=image/x-icon><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A Python typing pitfall when using Iterable[str]."><link rel=stylesheet href=/sass/main.min.f373b7caf8469f5497cf264480a94adf65adff6d9384dd07f6f7f1ec1024ef2d.css><link rel=stylesheet href=/sass/header.min.3a05763a683cf36d1c69c38bcd70ef997e4139b9f5b7b964ce4ec50f69a2a4e3.css><link rel=stylesheet href=/sass/footer.min.eaac730dad5c96ec74b1b6ad615c2653058b703041364f7f2f29ffe0deb6b650.css><link rel=stylesheet href=/sass/code.min.a20af48ca3a864274a8c935eafe4779c5aec4b9e19e252fb0df3f7147401df13.css><a rel=me href=https://recurse.social/@robinovitch61></a></head><body><header><div class=header-content><a href=/><div class=logo>THE LEO ZONE</div></a><div class=stripes><div class="stripe top"></div><div class="stripe middle"></div><div class="stripe bottom"></div></div><a href=/><div class=sun><div class=stripes></div></div></a><div class=nav><a href=/ target=_self>home</a>
<a href=https://github.com/robinovitch61 target=_blank>github</a>
<a href=/about target=_self>about</a></div></div></header><div class=content><div class=container><h1>iterable[str] in python</h1><div class=post-date><p>Oct 03, 2022</p></div><div class=post><p>Here&rsquo;s a fun thing with Python&rsquo;s type annotations.</p><p>Sometimes one might use <code>Iterable</code> as a type annotation to try to indicate something might be a set, a list, or a
tuple.</p><p>But <code>Iterable</code> really just means <a href=https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable>something that implements
<code>__iter__()</code></a>.</p><p>And <code>str</code> implements <code>__iter__()</code>, e.g.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>for</span> <span class=n>char</span> <span class=ow>in</span> <span class=s2>&#34;abc&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>char</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># a</span>
</span></span><span class=line><span class=cl><span class=c1># b</span>
</span></span><span class=line><span class=cl><span class=c1># c</span>
</span></span></code></pre></div><p>And &ldquo;a&rdquo; is a <code>str</code>, just like &ldquo;abc&rdquo; is a <code>str</code>.</p><p>So this type checks: <code>my_var: Iterable[str] = "abc"</code> (!!!).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Iterable</span><span class=p>,</span> <span class=n>List</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># these all pass type check</span>
</span></span><span class=line><span class=cl><span class=n>a</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;a&#34;</span>
</span></span><span class="line hl"><span class=cl><span class=n>b</span><span class=p>:</span> <span class=n>Iterable</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;abc&#34;</span>  <span class=c1># woops?</span>
</span></span><span class=line><span class=cl><span class=n>c</span><span class=p>:</span> <span class=n>Iterable</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;abc&#34;</span><span class=p>,</span> <span class=s2>&#34;def&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># this fails type check</span>
</span></span><span class=line><span class=cl><span class=n>d</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;abc&#34;</span>  
</span></span></code></pre></div><p>A fun footgun to be aware of :). Get more specific with types to avoid unexpectedly
correct-but-not-what-was-meant annotations.</p></div></div></div><footer><div class=nav><a href=/ target=_self>home</a></div><div class=woopsy>measure twice, cut once</div></footer></body></html>